"0","#| eval: false #this makes sure I don't re-run this anytime I want to output a pdf"
"0","#| tidy: true"
"0","#I first set an api key - this isn't necessary, but makes running code a bit easier. You may get an angry email from ncbi if you abuse this system though, so don't abuse it!"
"0","my_key=read.table(""G:/My Drive/ncbi_key.txt"")"
"2","Warning: incomplete final line found by readTableHeader on 'G:/My Drive/ncbi_key.txt'"
"0","set_entrez_key(my_key)"
"0",""
"0","#First we search for a group - here, a bunch of fungi, but you choose yours as appropriate"
"0","r_search = entrez_search(db=""nucleotide"",term=""COI[gene] AND Simiiformes[ORGN] AND 100:1000[SLEN]"",use_history = TRUE)"
"0","#We then process the returned results. First we download a summary of each record"
"0","r_summary = entrez_summary(db=""nucleotide"",web_history = r_search$web_history,retmax=500)"
"0","#Next we ask for what taxon each record belongs to"
"0","taxids = extract_from_esummary(r_summary,""taxid"")"
"0","#Finally, we get a list of one sample per taxon - this makes life a little easier"
"0","uids = extract_from_esummary(r_summary,""uid"")[match(unique(taxids),taxids)]"
"0","r_fastas = entrez_fetch(db=""nucleotide"",id=uids,rettype=""fasta"")"
"0","write(r_fastas,""data/test.fasta"")"
